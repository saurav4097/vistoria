<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VISTORIA</title>
    <link rel="stylesheet" href="index.css">

    <script>
        // Function to show the popup message
        function showPopupMessage(message) {
            alert(message); // This is a simple way to show a popup message
        }

        window.onload = function() {
            // Check if there's a message in the URL
            const urlParams = new URLSearchParams(window.location.search);
            const message = urlParams.get('message');
            
            // If the message exists, show the popup
            if (message) {
                showPopupMessage(decodeURIComponent(message));
            }
        };

        // Search function to redirect based on the search query
        function search() {
            // Get the search input value
            var query = document.getElementById("searchInput").value;

            // Check if the search query is not empty
            if (query.trim() !== "") {
                // Redirect to a new page (for example, a search results page)
                window.location.href = "/search?query=" + encodeURIComponent(query);
            } else {
                // Optionally show an alert or take some other action if no input is provided
                alert("Please enter a search term.");
            }
        }
    </script>
</head>
<body>
    <!--bar 1**********************************************************-->
   <div class="bar1">
    <p>VISTORIA*</p>
    
    <div class="navsearchbar">
        <select class="searchbar">
            <option>All</option>
        </select>
        <!-- Updated input to include an id -->
        <input id="searchInput" placeholder="search MyBag" class="searchinput">
        <button class="searchicon" onclick="search()">
            <h1>üîç</h1>
        </button>
    </div>
    
    <!-- Profile Section -->
<div class="profile">
    <a href="/profile"> <!-- Wrap the icon with an anchor tag that links to the signup page -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
        </svg>
    </a>
</div>
      <div class="cart">
        <a href="/cart"> 
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-cart" viewBox="0 0 16 16">
        <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l1.313 7h8.17l1.313-7zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/>
      </svg></a></div>
    <!--bar 2**********************************************************-->
   </div> 
   <div class="bar2">
    <div class="menubar">
    
</div>
<a>fashion</a>
<a>sport</a>
<a>books</a>
<a>home</a>
<a>electronics</a>
<a>food</a>
   </div> 
   <!-- Circular Box -->
<div class="circular-box" >
    <a href="/shopkeeper">
    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-shop" viewBox="0 0 16 16">
        <path d="M2.97 1.35A1 1 0 0 1 3.73 1h8.54a1 1 0 0 1 .76.35l2.609 3.044A1.5 1.5 0 0 1 16 5.37v.255a2.375 2.375 0 0 1-4.25 1.458A2.37 2.37 0 0 1 9.875 8 2.37 2.37 0 0 1 8 7.083 2.37 2.37 0 0 1 6.125 8a2.37 2.37 0 0 1-1.875-.917A2.375 2.375 0 0 1 0 5.625V5.37a1.5 1.5 0 0 1 .361-.976zm1.78 4.275a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 1 0 2.75 0V5.37a.5.5 0 0 0-.12-.325L12.27 2H3.73L1.12 5.045A.5.5 0 0 0 1 5.37v.255a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0M1.5 8.5A.5.5 0 0 1 2 9v6h1v-5a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v5h6V9a.5.5 0 0 1 1 0v6h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1V9a.5.5 0 0 1 .5-.5M4 15h3v-5H4zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1zm3 0h-2v3h2z"/>
      </svg>
    </a>
      <h3>Add Your Shop</h3>
</div>
<!--bar 3**********************************************************-->
<div class="bar3">
<div class="bar31">
     <!--bar 311*****-->
    <% if (shops && shops.length > 0) { %>
        
            <a href="/shop/<%= shops[0]._id %>" class="shop-link">
        <div class="box1" id="box11">
            <div class="image31" style="background-image: url('images/shop.webp'); "></div>
               <h1><%=shops[0].shopname%> </h1>  
               <p><%=shops[0].location%></p>
        </div>
    </a>
        <% } %>
   
    <!--bar 312*****-->
    <% if (shops && shops.length > 1) { %>
        <a href="/shop/<%= shops[1]._id %>" class="shop-link">
        <div class="box1" id="box12">
            <div class="image31" style="background-image: url('images/shop.webp'); "></div>
               <h1><%=shops[1].shopname%> </h1>  
               <p><%=shops[1].location%></p>
        </div>
    </a>
        <% } %>
    <!--bar 313*****-->
    <% if (shops && shops.length > 2) { %>
        <a href="/shop/<%= shops[2]._id %>" class="shop-link">
        <div class="box1" id="box13">
            <div class="image31" style="background-image: url('images/shop.webp'); "></div>
               <h1><%=shops[2].shopname%> </h1>  
               <p><%=shops[2].location%></p>
        </div>
        </a>
        <% } %>
    <!--bar 314*****-->
    <% if (shops && shops.length > 3) { %>
        <a href="/shop/<%= shops[3]._id %>" class="shop-link">
        <div class="box1" id="box14">
            <div class="image31" style="background-image: url('images/shop.webp'); "></div>
               <h1><%=shops[3].shopname%> </h1>  
               <p><%=shops[3].location%></p>
        </div>
        </a>
        <% } %>
    <!--bar 313*****-->
</div>
<a href="/shoplist" class="explore-link">
<div class="bar33see_more">
    <h2>explore Shops></h2>
</div>
</a>


<div class="bar33category_wise">
    <h2>SHOP BY CATEGORY</h2>
</div>

<div class="product-grid">
    <% if (products && products.length > 0) { %>
        <% products.forEach(product => { %>
            <div class="product-card" >
                <a href="/product/<%= product._id %>" class="product-link">
                    <div class="product-image" style='background-image: url("data:image/jpeg;base64,<%= product.images[0] %>");'></div>
                    <div class="product-details">
                        <a><%= product.name %></a>
                        <p class="offer"><%= product.offer %>% OFF</p>
                    </div>
                    <button class="add-to-bag" data-id="<%= product._id %>">Add to Bag</button>
                </a>
            </div>
        <% }) %>
    <% } else { %>
        <p>No products available</p>
    <% } %>
    

</div>
<div class="bar33see_more" >
    <h2> <a href="/productlist" style="color: white;">Shop All ></a></h2>
</div>
<!--bar 3**********************************************************-->
<div class="bar4">
    <div class="backtotop">
        <pre>     ^
Back To Top</pre>
        </div>
    <div class="extra">
    <pre><a>Get to Know Us</a>
About Us
Careers
Press Releases
Amazon Science</pre>
        <pre><a>Connect with Us</a>
Facebook
Twitter
Instagram</pre>
            <pre><a>Make Money with Us</a>
Sell on Amazon
Sell under Amazon Accelerator
 Protect and Build Your Brand
Amazon Global Selling
Become an Affiliate
Fulfilment by Amazon
Advertise Your Products
Amazon Pay on Merchants</pre>
                <pre><a>Let Us Help You</a>
COVID-19 and Amazon
Your Account
Returns Centre
Recalls and Product Safety Alerts
100% Purchase Protection
Amazon App Download
Help</pre>
</div>
<div class="last">
    <p>MyBag*</p>
</div>
<div class="last2">
    <pre>   Thank you for being our valued customer.
 We are so grateful and hope we met your expectations. </pre>
</div>
</div>
<script>
    // Add to Cart button click handler
    document.querySelectorAll('.add-to-bag').forEach(button => {
        button.addEventListener('click', function () {
            const productId = this.getAttribute('data-id');
            
            // Send AJAX request to add product to cart
            fetch('/add-to-cart/' + productId, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ productId: productId }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Product added to cart!');
                    // Optionally, update cart UI elements, like cart count
                } else {
                    alert('Failed to add product to cart');
                }
            })
            .catch(error => console.error('Error:', error));
        });
    });
</script>
</body>
</html>